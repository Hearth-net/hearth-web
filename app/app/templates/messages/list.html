<div class="messages" dynamic-height offset="100" min-height="400">
	<div class="messages-top formStyle">
		<form class="search" method="POST" ng-submit="searchConversation()">
			<div class="slide-show" ng-class="{'width-auto': showFulltext}">
				<input type="text" ng-model="conversationSearch" placeholder="{{ 'MESSAGES.CONVERSATION_SEARCH_PLACEHOLDER' | translate}}">
			</div>
			<button class="button-icon fa fa-search"></button>
		</form>
		<select class="messages-filter" ng-model="conversationFilter">
			<option value="all" ng-selected="conversationFilter == 'all'">{{ 'MESSAGES.FILTER.ALL' | translate }}</option>
			<option value="post-reply" ng-selected="conversationFilter == 'post-reply'">{{ 'MESSAGES.FILTER.POST_REPLIES' | translate }}</option>
			<option value="users-posts" ng-selected="conversationFilter == 'users-posts'">{{ 'MESSAGES.FILTER.USERS_POSTS' | translate }}</option>
			<option value="communities-posts" ng-selected="conversationFilter == 'communities-posts'">{{ 'MESSAGES.FILTER.COMMUNITIES_POSTS' | translate }}</option>
			<option value="archive" ng-selected="conversationFilter == 'archive'">{{ 'MESSAGES.FILTER.ARCHIVE' | translate }}</option>
		</select>

		<a class="button-send right" ng-click="showNewMessageForm = !showNewMessageForm">{{ 'MESSAGES.ADD_NEW_MESSAGE' | translate }}</a>
		<div class="clear"></div>
		<div loading show="!conversations"></div>
	</div>
	
	<div class="messages-container" ng-if="conversations" dynamic-height offset="60" container=".messages" min-height="340">
		<div class="collumn left conversations">
			<div class="scrollbar-macosx" ng-if="conversations" custom-scrollbar class-if-overflow="shadow-bottom">
				<div class="border-bottom" ng-class="{'active-bottom': !detailIndex}"></div>
				<div class="text-center" ng-if="!conversations.length">
					{{ 'MESSAGES.LIST.NO_RESULT' | translate }}
				</div>
				<div class="conversation" ng-class="{'conversation-unreaded': !item.read, active: detailIndex === $index, 'active-bottom': detailIndex -1 === $index}" ng-repeat="item in conversations" ng-click="showConversation(item, $index)">
					<div class="avatars avatar-count-{{item.participants_count | minMax:0:4}}">
						<avatar src="person.avatar.normal" size="medium" type="person._type" ng-repeat="person in item.participants | limitTo:4:4"></avatar>
					</div>
					<div class="conversation-info">
						<h2 ng-if="item.title">{{ item.title }}</h2>
						<h2 ng-if="!item.title"><i>{{ 'MESSAGES.LIST.CONVERSATION_HAS_NO_TITLE' | translate }}</i></h2>

						<p ng-if="item.message.text">{{ item.message.text | ellipsis:60 }}</p>
						<i class="fright" ng-if="item.last_message_time" title="{{ item.last_message_time | date:mediumTime }}">{{ item.last_message_time | ago }}</i>
					</div>
					<div class="clear"></div>
				</div>
			</div>
		</div>
		<div class="collumn box right conversation-detail-container">
			<conversation-add></conversation-add>
			<!-- <conversation-detail ng-if="! showNewMessageForm && detail" info="detail"></conversation-detail> -->
		</div>
		<div class="clear"></div>
	</div>
</div>
