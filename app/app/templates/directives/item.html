<article class="row" ng-class="{offer: item.type == 'offer', need: item.type == 'need', edit: edit, mineItem: mine}">
	<section class="large-2 columns photo">
		<div ng-include="'templates/_user-info.html'"></div>
		<a ng-href="#!/{{profileLinkType[item.author._type]}}/{{ item.author._id }}">
			<div class="avatar" ng-style="avatarStyle"></div>
			<div class="name">{{ item.author.name }}</div>
		</a>
		<div class="karma" ng-class="{empty: !item.karma}">
			<div class="positive" ng-style="item.karma"></div>
		</div>
		<div class="timeline"></div>
	</section>
	
	<section class="large-10 columns">
		<div class="item" ng-class="item.type">
			<div class="overlap"> </div>
			<div class="arrowbox"></div>
			<div class="arrow"></div>
			<div class="content">
				<header>
					<div class="locations" ng-if="item.locations.length && item.locations[0].short_address">
						<span class="fa fa-map-marker"></span>
						{{ item.locations[0].short_address }}</span>
						<a ng-if="item.locations.length > 1" data-dropdown="{{'locations' + item._id}}">{{'and-next' | translate: {value: item.locations.length - 1} }}</a>
						<div id="{{'locations' + item._id}}" class="location-dropdown content" data-dropdown-content>
							<div ng-repeat="location in item.locations track by $index">
								<span class="fa fa-map-marker"></span> {{ location.short_address }}
							</div>
						</div>
					</div>
					<span class="date" title="{{item.updated_at | date:'dd.MM.yyyy HH:mm:ss'}}"><span class="fa fa-clock-o"></span>{{item.updated_at | ago}}</span>
				</header>
				<h1>
					<span ng-if="item.type == 'need'">{{ 'DOES_WISH' | translate }}</span>
					<span ng-if="item.type == 'offer'">{{ 'DOES_GIVE' | translate }}</span>
					{{item.title}}
				</h1>
				<div class="text-container">
					<div class="expandable">
						<p ng-bind-html="item.name | linky:'_blank'"></p>
					</div>
				</div>
				<div class="attachments" ng-if="item.attachments_attributes.length" fancybox>
					<a class="fancy" ng-href="{{ photo.file }}" rel="{{ item._id }}" ng-repeat="photo in item.attachments_attributes">
						<img ng-src="{{ photo.normal }}">
					</a>	
				</div>
				<div class="tags" ng-if="item.keywords.length">
					<ul class="tagList">
						<li ng-click="toggleTag(tag)" ng-class="{active: keywordsActive.indexOf(tag) !== -1}" ng-repeat="tag in item.keywords">
							{{tag}}
						</li>
					</ul>
				</div>
				<a ng-if="showMore" class="show-more" ng-click="toggleCollapsed()">
					<span>{{ 'show-more' | translate }} <i class="fa fa-chevron-down"></i></span>
					<span>{{ 'show-less' | translate }} <i class="fa fa-chevron-up"></i></span>
				</a>
				<div class="clear"></div>
			</div>
			<footer>
				<a signed-out class="report-link spam fa fa-flag" ng-if="! mine" title="{{'REPORT_HARMFUL_AD' | translate}}" ng-click="toggleReportNotLoggedIn()">
				</a>
				<a signed-in class="report-link spam fa fa-flag" ng-if="! mine" title="{{'REPORT_HARMFUL_AD' | translate}}" data-reveal-id="confirm-report">
				</a>
				<div class="share">
					<div class="fa fa-share-square-o"></div>
					<div class="sharing">
						<div>
							<a class="fa fa-facebook" title="Facebook" ng-href="{{facebook}}" target="_blank"></a>
							<a class="fa fa-google-plus" title="Google+" ng-href="{{gplus}}" target="_blank"></a>
							<a class="fa fa-twitter" title="Twitter" ng-href="{{twitter}}" target="_blank"></a>
							<a class="fa fa-envelope" ng-href="{{mail}}" title="Email"></a>
						</div>
					</div>
				</div>
				<div class="controll-buttons" ng-if="mine">
					<div class="fa fa-pencil" title="{{'AD_EDIT_LABEL' | translate}}" ng-click="edit()"></div>
					<div class="fa fa-play" title="{{'AD_RESUME_LABEL' | translate}}" ng-if="!item.is_active" ng-click="pauseToggle()"></div>
					<div class="fa fa-pause" title="{{'A;D_PAUSE_LABEL' | translate}}" ng-if="item.is_active" data-reveal-id="confirm-pause-{{item._id}}"></div>
					<div class="fa fa-times" title="{{'AD_REMOVE_LABEL' | translate}}" data-reveal-id="confirm-delete-{{item._id}}"></div>
				</div>
				<div id="confirm-delete-{{item._id}}" class="reveal-modal tiny" data-reveal>
					<article class="row">

						<section class="large-12 columns">
							<h2>{{'AD_REMOVE_LABEL' | translate}}</h2>
							<p><i class="fa fa-question-circle"></i> {{'AD_REMOVE_ARE_YOU_SURE' | translate}}</p>
							</section>
					</article>
					<article class="row">
						<section class="large-6 columns">
							<button ng-click="remove()">{{'OK' | translate}}</button>
						</section>
						<section class="large-6 columns text-right">
							<a class="link-button" ng-click="cancel()">{{'CANCEL' | translate}}</a>
						</section>
					</article>
				</div>
				<div id="confirm-pause-{{item._id}}" class="reveal-modal tiny" data-reveal>
					<article class="row">

						<section class="large-12 columns">
							<h2>{{'AD_PAUSE_LABEL' | translate}}</h2>
							<p><i class="fa fa-question-circle"></i> {{'AD_PAUSE_ARE_YOU_SURE' | translate}}</p>
							</section>
					</article>
					<article class="row">
						<section class="large-6 columns">
							<button ng-click="pauseToggle()">{{'OK' | translate}}</button>
						</section>
						<section class="large-6 columns text-right">
							<a class="link-button" ng-click="cancel()">{{'CANCEL' | translate}}</a>
						</section>
					</article>
				</div>

				<div id="confirm-report" class="reveal-modal tiny" data-reveal>
					<article class="row">
						<section class="large-12 columns">
							<h2>{{'AD_REPORT_CONFIRM' | translate}}</h2>
							<p><i class="fa fa-question-circle"></i> {{'AD_REPORT_ARE_YOU_SURE' | translate}}</p>
							</section>
					</article>
					<article class="row">
						<section class="large-6 columns">
							<button ng-click="report()">{{'OK' | translate}}</button>
						</section>
						<section class="large-6 columns text-right">
							<a class="link-button" ng-click="cancel()">{{'CANCEL' | translate}}</a>
						</section>
					</article>
				</div>

				<button ng-if="!mine" ng-click="startEditReply()" ng-disabled="replyEdit"  class="small main" ng-class="{secondary: item.type == 'offer'}">
					<span ng-if="item.type == 'offer'" ng-bind-html="'WISH_GIFT' | translate"></span>
					<span ng-if="item.type == 'need'" ng-bind-html="'OFFER_GIFT' | translate"></span>
				</button>
				<span ng-if="item.type == 'offer' &&  item.reply_count" ng-bind-html="'PEOPLE_COUNT_WISH' | translate: {value: item.reply_count}"></span>
				<span ng-if="item.type == 'need' &&  item.reply_count" ng-bind-html="'PEOPLE_COUNT_OFFER' | translate: {value: item.reply_count}"></span>
				<span ng-if="item.reply_count==0">{{'NO_REPLY' | translate}}</span>
				<div class="footer-container" ng-show="replyEdit || adEdit || reported || reportNotLoggedIn">
					<div ng-show="reported">
						<div class="animate-show" ng-cloak >
							<article class="row">
								<section class="large-12 columns">
									<div class="radius alert-box warning" >
										<span>{{'THANKS_FOR_REPORT' | translate}}</span>
										 <a class="close" ng-click="reported=false" >&times;</a>
									</div>
								</section>
							</article>
						</div>
					</div>
					<div signed-out class="not-logged-container animate-show" ng-show="reportNotLoggedIn">
						<article class="row">
							<section  class="large-12 columns">
								<div class="radius alert-box info" signed-out ng-cloak >
									<span translate>LOG_IN_BEFORE_REPORT</span>
									 <a class="close" ng-click="reportNotLoggedIn=false" >&times;</a>
								</div>
							</section>
						</article>
					</div>

					<div signed-in ng-if="!mine" ng-show="replyEdit" class="reply-box animate-show">
						<article class="row">
							<section class="large-12 columns">
								<form name="replyForm">
									<div class="animate-show" ng-show="replyForm.$invalid && replyForm.$dirty">
										<div class="alert-box radius">
											<div ng-show="replyForm.message.$error.minlength">{{ 'ERR_AD_NAME_MIN_LEN' | translate }}</div>
											<div ng-show="replyForm.message.$error.maxlength">{{ 'ERR_AD_NAME_LEN' | translate }}</div>
											<div ng-show="replyForm.message.$error.required">{{ 'ERR_REPLY_EMPTY_MESSAGE' | translate }}</div>
											<div ng-show="replyForm.agree.$error.required">{{ 'ERR_REPLY_PLEASE_AGREE' | translate }}</div>
										</div>
									</div>
									<div class="animate-show" ng-show="submited">
										<div class="alert-box info radius" >{{ 'SENDING_MESSAGE_SUCCESS' | translate }}</div>
									</div>
									{{message}}
									<textarea name="message" ng-model="reply.message" ng-minlength="3" ng-maxlength="500" ng-required="true"></textarea>
									<label>
										<input type="checkbox" name="agree" ng-required="true" ng-model="reply.agree">
									 	{{ 'REPLY_PUBLISH_EMAIL_AGREE' | translate:agreeTranslationData }}
									</label>
								</form>
							</section>
						</article>
						<article class="row">
							<section class="large-8 columns">
								<a ng-click="cancelEdit()" class="link-button">{{'CANCEL' | translate}}</a>
							</section>
							<section class="large-4 columns text-right">
								<button ng-click="sendReply()" ng-disabled="replyForm.$invalid" ng-class="{secondary: item.type == 'offer'}">
									<span class="fa fa-envelope"></span>
									{{'SEND' | translate}}
								</button>
							</section>
						</article>
					</div>
					<div signed-out class="not-logged-container animate-show" ng-show="replyEdit">
						<article class="row">
							<section  class="large-12 columns">
								<div class="radius alert-box info" signed-out ng-cloak >
									<span translate>LOG_IN_TO_POST_NEW_WISHES</span>
									 <a class="close" ng-click="replyEdit = false" >&times;</a>
								</div>
							</section>
						</article>
					</div>
				</div>
				<div class="clear"></div>
			</footer>
		</div>
	</section>
</article>