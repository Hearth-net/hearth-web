<div id="item-detail">
	<div loading show="!loaded"></div>

	<div ng-if="loaded" class="ad-detail-page web-width">
		<article class="row">
			<section ng-show="ad && ! ad.name && ad.state === 'suspended'" class="ad-not-found box large-6 margin-auto text-center">
				<p class="margin-0 padding-top">{{ 'POST_WAS_SUSPENDED' | translate }}</p>
			</section>
			<section ng-show="! adDeleted && ad === false" class="ad-not-found box large-6 margin-auto text-center">
				<p class="margin-0 padding-top">{{ 'POST_NOT_FOUND' | translate }}</p>
			</section>
			<section ng-show="adDeleted" class="ad-not-found box large-6 margin-auto text-center">
				<p class="margin-0 padding-top">{{ 'POST_WAS_DELETED' | translate }}</p>
			</section>
			<section ng-if="! adDeleted && ad && ad.name" class="large-12 post" id="item_container_{{ ad._id }}">
				<div class="content row">
					<div class="columns large-4 ad-author-column">
						<div class="text-center">
							<avatar type="ad.author._type" src="ad.author.avatar.large" size="large" href="'#!/'+getProfileLinkByType(ad.author._type)+'/'+ad.author._id" /></avatar>
						</div>
						<a ng-href="{{'#!/'+getProfileLinkByType(ad.author._type)+'/'+ad.author._id}}"><h2>{{ ad.author.name}}</h2></a>

						<a ng-href="{{'#!/'+getProfileLinkByType(ad.author._type)+'/'+ad.author._id}}">
							<div ng-if="ad.author" class="karma-bar" title="{{ 'COUNT_OF_PLUS_POINTS' | translate }}: {{ ad.author.up_votes }} | {{ 'COUNT_OF_MINUS_POINTS' | translate }}: {{ ad.author.down_votes }}">
								<span class="positive bar" ng-style="{width: (karma)+'%'}" ng-class="{full: karma == 100}" ng-if="karma != null && karma > 0">
								</span>
								<span class="negative bar" ng-style="{width: (100 - karma)+'%'}" ng-class="{full: karma == 0}" ng-if="karma != null && karma < 100">
								</span>
							</div>
						</a>

						<div class="box" ng-if="profile">
							<div class="line">
								<div class="descr" ng-if="profile.about"><i class="fa fa-quote-right"></i> {{profile.about|ellipsis}}</div>
								<div class="descr" ng-if="profile.work"><i class="fa fa-briefcase"></i> {{profile.work|ellipsis}}</div>
								<div class="descr" ng-if="profile.locations.length && profile.locations[0].short_address">
									<i class="fa fa-map-marker"></i> {{'you-will-find-me' | translate}} 
									<span ng-repeat="(locationId, location) in profile.locations">
										<span ng-if="location.short_address">{{location.short_address}}<span ng-if="!$last">;</span></span>
									</span>
								</div>
								<div class="descr" ng-if="profile.interests && profile.interests[0] != ''"><i class="fa fa-smile-o"></i> {{ profile.interests.join(", ") }}</div>
								<div class="descr" ng-if="profile.user_languages">
									<span ng-repeat="(languageCode, enabled) in profile.user_languages">
										<i class="fa fa-comments" ng-if="$first"></i>
										{{ 'MY_LANG.' + languageCode | translate }}<span ng-if="!$last">,</span>
									</span>
								</div>
								<div class="descr" ng-if="profile.webs.length && profile.webs[0]">
									<i class="fa fa-link"></i> 
									<span ng-repeat="(code, web) in profile.webs">
										<a target="_blank" class="link" ng-href="{{ web }}">{{ web | protocolfree | ellipsis:20 }}</a><span ng-if="!$last">, </span>
									</span>
								</div>
							</div>
							<div class="line">
								<div class="social fleft">
									<a target="_blank" ng-if="profile.twitter" href="{{profile.twitter}}"><i class="fa fa-twitter-square"></i></a>
									<a target="_blank" ng-if="profile.facebook" href="{{profile.facebook}}"><i class="fa fa-facebook-square"></i></a>
									<a target="_blank" ng-if="profile.googleplus" href="{{profile.googleplus}}"><i class="fa fa-google-plus-square"></i></a>
									<a target="_blank" ng-if="profile.linkedin" href="{{profile.linkedin}}"><i class="fa fa-linkedin"></i></a>
								</div>
								<div class="fright">
									<a class="profile-link" ng-href="{{'#!/'+getProfileLinkByType(profile._type)+'/'+profile._id}}">{{ 'WHOLE_PROFILE' | translate }}</a>
								</div>
							</div>
						</div>
					</div>

					<div class="columns large-8 ad-detail-column">
						<item keywords-active="{}" item-detail="true" user="user" item="ad" community="loggedCommunity" inactivate-tags="true" hide-avatar="true" not-expandable="true" foundation-columns-classname="'large-12'"></item>
					</div>

					<div class="large-8 columns no-padding" ng-if="isMine || (ad.locations.length && !ad.location_unlimited)">
						<div class="bottom-tabs">
							<ul>
								<li ng-if="isMine">
									<a href="" ng-click="page.currentPageSegment='detail.replies'" ng-class="{selected: page.currentPageSegment =='detail.replies'}">
										{{ 'AD_REPLIES' | translate }}
									</a>
								</li>
								<li ng-if="ad.locations.length && !ad.location_unlimited">
									<a href="" ng-click="page.currentPageSegment='detail.map'" ng-class="{selected: page.currentPageSegment =='detail.map'}">
										{{ 'AD_PLACES' | translate }}
									</a>
								</li>
							</ul>
						</div>
					</div>
					<div class="large-8 rating-listing ratings-received left" ng-if="isMine && page.currentPageSegment == 'detail.replies'">
						<div class="large-12 large-centered columns box text-center no-result" ng-if="!replies.length"><p>{{'NO_REPLY' | translate}}</p></div>
						<article class="row rating-item rating_{{ item._id }}" ng-repeat="(id, item) in replies">
							<section class="large-2 columns user">
								<a ng-href="#!/{{ getProfileLinkByType(item.author._type) }}/{{item.author._id}}">
									<avatar src="item.author.avatar.normal" type="item.author._type"></avatar>
									<div class="name">{{ item.author.name }}</div>
								</a>
							</section>
							<section class="large-10 columns">
								<div class="item rating-received">
									<div class="overlap"> </div>
									<div class="arrowbox"></div>
									<div class="arrow"></div>
									<div class="content">
										<div class="fright">
											<div class="date" title="{{item.created_at | date:DATETIME_FORMATS.medium}}"><i class="fa fa-clock-o"></i>&nbsp; {{ item.created_at | ago }}</div>
										</div>
										<div class="text-container clearfix">
											<p ng-bind-html="item.message | linky:'_blank' | nl2br"></p>
										</div>
										<div style="text-right smaller"><small ng-bind-html="'YOU_CAN_CONTACT_USER' | translate: {email: item.author_email}"></small></div>
									</div>
								</div>
							</section>
						</article>
					</div>

					<div class="large-8 box map-box" ng-if="(ad.locations.length && !ad.location_unlimited) && (!isMine || page.currentPageSegment == 'detail.map')">
						<ul class="address">
							<li ng-repeat="(locationId, location) in ad.locations">
								<i class="fa fa-map-marker"></i> &nbsp; {{ location.address }}
							</li>
						</ul>
						<mapitems ng-if="ad.locations && ad.locations.length" class="map" items="ad.locations"></mapitems>
					</div>
				</div>
			</section>
		</article>
	</div>
</div>