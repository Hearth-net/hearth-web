<div class="content">
	<h5 class="text-emphasize">{{:: 'ADD_USER_RATING' | translate }} {{info.name}}</h5>
	<div class="rating-notify-box"></div>
	<h6>{{:: 'USER_RATING_SCORE_SELECT_TEXT' | translate }}</h6>

	<div class="block">
		<author-selector id="author" author-id="rating.current_community_id" author="rating.current_community" remove="info._id"></author-selector>
	</div>

	<div class="block">
		<needofferselector required-shown='rating.requiredMessageShown' model="rating.score" text-true="{{:: 'POSITIVE' | translate}}" text-false="{{:: 'NEGATIVE' | translate}}"></needofferselector>
	</div>

	<form ng-submit="sendRating(rating, ratingForm)" id="ratingForm" name="ratingForm" novalidate>
		<h6>{{:: 'RATING_COMMON_POSTS_TOP' | translate}}</h6>
		<span ng-if="loadingRatingPosts">
			<i class="fa fa-spin fa-spinner"></i> {{:: 'COMMON.LOADING' | translate }}
			<br>
		</span>

		<div class="block">
			<div class="padding-bottom-3">
				{{:: 'USER_RATING_JOIN_REALIZED_GIFT' | translate }}
			</div>
			<select class="full-width select-style" id="ratingsPostsSelect" ng-model="rating.post_id">
				<option value="" ng-selected="true">{{:: 'USER_RATING_CHOOSE_POST_TO_JOIN' | translate }}</option>
				<optgroup ng-if="ratingPosts.length && loadedRatingPosts && !loadingRatingPosts" label="{{:: 'RATING_POST_TITLE' | translate }}">
					<option ng-repeat="post in ratingPosts" title="{{:: post.title}}" value="{{:: post._id }}">
						{{:: postTypes[rating.current_community._id != loggedUser._id ? "Community" : "User"][post.exact_type][post.type] | translate }} {{:: post.title | ellipsis:40 }} ({{post.owner_id === loggedUser._id ? loggedUser.name : info.name}})
					</option>
				</optgroup>
				<optgroup ng-if="ratingActivePosts.length && loadedRatingPosts && !loadingRatingPosts" label="{{:: 'RATING_ACTIVE_POST_TITLE' | translate }}">
					<option ng-repeat="post in ratingActivePosts | orderBy: '-updated_at'" title="{{:: post.title}}" value="{{:: post._id }}">
						{{:: postTypes[post.author._type][post.type] | translate }} {{:: post.title | ellipsis:40 }} ({{post.author.name}})
					</option>
				</optgroup>
			</select>
		</div>

		<div class="block" ng-if="(!ratingPosts.length && loadedRatingPosts && !loadingRatingPosts) && (!ratingActivePosts.length && loadedRatingPosts && !loadingRatingPosts)" translate="RATING_NO_COMMON_POST_IN_3_MONTHS"></div>

		<label class="block">
			<span translate="RATINGS_LABEL_WRITE_SOME_WORD"></span>
			<input-max-length input-type="textarea" show-counter="true" min-length="{{:: rating_setup.RATING_TEXT_MIN_LENGTH }}" max-length="{{:: rating_setup.RATING_TEXT_MAX_LENGTH }}" isrequired="yes" placeholder="{{'WRITE_USER_SOME_RATING' | translate }}" model="rating.text" name="text" id="reply-text"></input-max-length>
			<div class="form-error" ng-show="showError.text">
				<span ng-show="ratingForm.text.$error.required">{{:: 'ERR_NOT_FILLED_RATING' | translate }}</span>
				<span ng-show="ratingForm.text.$error.minlength">{{:: 'ERR_RATING_IS_TOO_SHORT' | translate }}</span>
			</div>
		</label>

		<div class="flex flex-space-between flex-reverse">
			<button type="submit" class="button" ng-class="{ 'positive': rating.score == true, 'negative': rating.score == false, 'neutral': isNull(rating.score)}">
				{{:: 'SEND_USER_RATING' | translate }} &nbsp;
				<i class="score-icon fa" ng-hide="isNull(rating.score)" ng-class="{'icon-rating-negative': rating.score == false,'icon-rating-positive': rating.score}"></i>
			</button>
			<a ng-click="closeUserRatingForm()" tabindex="0" class="revert-changes" translate="CANCEL"></a>
		</div>

	</form>
</div>