<div id="notify-container-market"></div>
<div class="market">
  <div class="small-12 large-9 columns">

    <div ng-if="infoMessageToShow" class="row margin-horizontal-none margin-bottom-large">
      <div class="column medium-10 medium-push-2 padding-medium close-wrapper box">
        <div ng-click="$parent.infoMessageToShow = ''" class="touchable close">
          <i class="fa fa-times"></i>
        </div>
        <div ng-bind-html="$parent.infoMessageToShow"></div>
      </div>
    </div>

    <filterbar></filterbar>
    
    <div>
      <div class="callout alert" ng-if="firstPageNotShown()" translate="MARKETPLACE.NOT_ON_FIRST_PAGE" translate-values="{sref: 'market({page: 1})'}" translate-compile></div>
      <div class="callout alert" ng-if="showLimitedPostsMessageAuth" translate="LIMITED_POSTS_MESSAGE_AUTH" translate-compile translate-values="{'attrs': 'ng-href=\'profile-edit\''}">logged</div>
      <div class="callout alert" ng-if="showLimitedPostsMessageUnauth" translate="LIMITED_POSTS_MESSAGE_UNAUTH"></div>
    </div>

    <div ng-hide="!loaded">
      <div class="marketplace-items-container" ng-if="!items.length && !dataFetchError">
        <div ng-show="filterIsOn" class="row block">
          <div class="column box text-center">
            <p translate="MARKETPLACE.FILTER_NOT_FOUND"></p>
            <div class="small-6 columns text-center">
              <a ng-click="toggleFilter()" translate="MARKETPLACE.EDIT_FILTER"></a>
            </div>
            <div class="small-6 columns text-center">
              <a ng-click="resetFilter()" translate="MARKETPLACE.RESET_FILTER"></a>
            </div>
          </div>
        </div>
        <div ng-show="!filterIsOn" class="block">
          <div class="box text-center" translate="MARKETPLACE.NOTHING_FOUND_WITH_OPTIONS" translate-compile translate-values="{changeFilterAttrs: 'ng-click=\'toggleFilter()\'', editLangsAttrs: 'ui-sref=\'profileEdit\''}" ></div>
        </div>
      </div>
      <div ng-if="dataFetchError" class="block">
        <div class="box text-center" translate="MARKETPLACE.NOTHING_FOUND" translate-values="{attrs: 'ui-sref=\'market\' ui-sref-opts=\'{reload: true, notify: true}\''}" translate-compile></div>
      </div>
      <div ng-if="!dataFetchError">
        <exemplary-posts opts="epOpts" ng-if="!filterIsOn && epOpts"></exemplary-posts>
        <div class="row" ng-if="items.length">
          <div class="column medium-10 medium-push-2 text-center">
            <h1 class="header-3" translate="{{marketTitle}}"></h1>
            <h2 class="header-6" ng-if="filterIsOn"><a translate="MARKETPLACE.SHOW_ALL" ng-click="resetFilter()"></a></h2>
          </div>
        </div>
        <div id="market-item-list" when-scrolled="load()" offset="1000" loading-in-progress="loading || disableLazyLoad" class="marketplace-items-container">
        </div>
      </div>
    </div>

    <div loading show="loading"></div>
  </div>

  <div class="large-3 hide-for-small-only hide-for-medium-down show-for-large columns">
    
    <div class="margin-bottom-tiny">
      <a ng-click="editItem(null)" ng-class="{pressed: newItemSelected}" class="button display-block padding-top-medium padding-bottom-medium" test-beacon="new-post-button" translate="MARKETPLACE.ACTION_CREATE_POST"></a>
    </div>

    <!-- BANNER -->
    <marketplace-banner class="clearfix"></marketplace-banner>

    <!-- BLOGPOSTS -->
    <h4 translate="HEARTH.BLOG.GET_INSPIRED" class="text-center margin-bottom-small margin-top-large"></h4>

    <section class="padding-bottom-small">
      <div class="">
        <div class="box padding-none margin-bottom-medium" ng-repeat="post in blogposts">
          <a ng-href="{{ post.link }}" class="blog-image display-block" ng-style="{'background-image': 'url(' + post.image.src + ')' }" title="{{ post.image.src }}"></a>
          <div class="padding-small">
            <h5>
              <a ng-href="{{ post.link }}" ng-bind="post.title"></a>
            </h5>
          </div>
        </div>
      </div>
    </section>

  </div>
</div>
